(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{"3fRZ":function(t,e,n){"use strict";var o=n("ex6f"),i={props:{value:{type:null|Object,default:function(){return null}},api_url:{type:String,default:null,required:!0},prepend:{type:String,default:""},append:{type:String,default:""},placeholder:{type:String,default:"Search Items"},size:{type:String,default:"sm"},autocomplete:{type:String,default:"off"},dropdownVariant:{type:String,default:"outline-secondary"},emptyOptionText:{type:String,default:"No items available to select"},inputClass:{type:String|Array,default:function(){return[]}},menuStyle:{type:String|Array,default:function(){return[]}},clearSearchOnItemSelected:{type:Boolean,default:!1},initOptions:{type:Boolean|String,default:!1},required:{type:Boolean,default:!1},state:{type:Boolean,default:null},hideDdIcon:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},menuClass:{type:String|Object,default:function(){return""}},getFiltered:{type:Function},clearSearchOnDropdownHidden:{type:Boolean,default:function(){return!0}},optionText:{type:Function},tagText:{Type:Function}},data:function(){return{options:[],query:"",selected_item:null}},mounted:function(){this.initOptions&&(Object(o.a)(this.initOptions)&&this.initOptions?this.getItems(""):this.query=this.initOptions),this.$set(this,"selected_item",this.value)},computed:{getOptions:function(){return"function"==typeof this.getFiltered&&this.getFiltered?this.getFiltered(this.options):this.options}},watch:{value:{deep:!0,handler:function(t){this.$set(this,"selected_item",t)}}},methods:{reset:function(){this.$emit("input",null),this.$set(this,"selected_item",null),this.query=""},itemSelected:function(t){this.$emit("input",t),this.$set(this,"selected_item",t),this.clearSearchOnItemSelected&&(this.query=null)},getItems:function(t){var e=this;axios.post(this.api_url,{query:this.query}).then((function(t){e.$set(e,"options",t.data||[])})).catch((function(t){e.$set(e,"options",[]),console.error(t.response)}))}}},r=(n("c9im"),n("KHd+")),s=Object(r.a)(i,(function(){var t=this,e=this,n=e.$createElement,o=e._self._c||n;return o("div",{staticClass:"vue-select form-control p-0",class:{"is-invalid":null!==e.state&&e.state,"is-valid":null!==e.state&&!e.state,"form-control-sm":"sm"===e.size,"form-control-lg":"lg"===e.size,"form-control-xl":"xl"===e.size}},[e.required?o("input",{staticStyle:{height:"0",position:"absolute",top:"0",border:"0",outline:"0","z-index":"-1"},attrs:{type:"text",required:!0},domProps:{value:e.value?"initialized":""}}):e._e(),e._v(" "),o("b-dropdown",{class:{"hide-dd-icon":e.hideDdIcon,disabled:e.disabled},style:e.menuStyle,attrs:{block:"",lazy:"",variant:e.dropdownVariant,size:e.size,disabled:e.disabled,"toggle-class":"text-left m-0 border-0 border-radius-0","menu-class":e.menuClass},on:{hidden:function(){e.$emit("hidden",!0),t.clearSearchOnDropdownHidden&&(t.query="")}},scopedSlots:e._u([{key:"button-content",fn:function(){return[e._t("tag",[e._v("\n                "+e._s("function"==typeof e.tagText?e.tagText(e.selected_item):(e.selected_item,e.placeholder))+"\n            ")],{tag:e.selected_item})]},proxy:!0}],null,!0)},[e._v(" "),o("div",{staticClass:"px-2"},[o("b-form-input",{class:e.inputClass,attrs:{autofocus:"",type:"search",size:e.size,placeholder:e.placeholder,autocomplete:e.autocomplete},on:{keypress:function(t){if(!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter"))return null;t.preventDefault()},input:function(t){return e.getItems(t)}},model:{value:e.query,callback:function(t){e.query=t},expression:"query"}})],1),e._v(" "),o("b-dropdown-divider"),e._v(" "),e._l(e.getOptions,(function(t,n){return o("b-dropdown-item",{key:n,on:{click:function(n){return e.itemSelected(t)}}},[e._t("option",[e._v("\n                "+e._s("function"==typeof e.optionText?e.optionText(t):t)+"\n            ")],{item:t,query:e.query})],2)})),e._v(" "),0===e.options.length?[e._t("empty",[0===e.options.length?o("b-dropdown-text",[e._v("\n                    "+e._s(e.emptyOptionText)+"\n                ")]):e._e()],{query:e.query})]:e._e(),e._v(" "),e._t("default_item",null,{query:e.query})],2)],1)}),[],!1,null,null,null);e.a=s.exports},QK5V:function(t,e,n){var o=n("LboF"),i=n("xA+E");"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[t.i,i,""]]);var r={insert:"head",singleton:!1};o(i,r);t.exports=i.locals||{}},c9im:function(t,e,n){"use strict";var o=n("QK5V");n.n(o).a},jVxK:function(t,e,n){"use strict";n.r(e);var o=n("X/aF"),i=n("3fRZ"),r={customer_id:null,previous_balance:0,paid:0,total:0,items:[],note:null},s={components:{VueSelect:i.a},props:{item:{type:Object,default:function(){return null}}},data:function(){var t=this;return{BasicModalOptions:o.a,temp_customer:null,product_temp:null,form:JSON.parse(JSON.stringify(r)),item_fields:[{key:"action",label:_t("action","Action")},{key:"name",label:_t("name","Name"),formatter:function(t,e,n){return[n.product_id,n.name,n.code].join(" # ")}},{key:"price",label:_t("price","Price"),formatter:function(e){return t.$options.filters.currency(e)}},{key:"quantity",label:_t("quantity","Quantity"),formatter:function(e){return t.$options.filters.localNumber(e)}},{key:"total",label:_t("total","Total"),formatter:function(e){return t.$options.filters.currency(e)}}]}},mounted:function(){var t=this;this.item&&Object.keys(this.item).length?this.setData(JSON.parse(JSON.stringify(this.item))):this.the_item&&Object.keys(this.item).length||axios.post(route("Backend.Orders.List"),{id:this.$route.params.id}).then((function(e){t.setData(e.data)})).catch((function(t){return console.log(t.response)}))},computed:{total:function(){if(!this.form.items.length)return 0;var t=0;return this.form.items.forEach((function(e){t+=e.price*e.quantity})),t},currentBalance:function(){return Number(this.total)+Number(this.form.previous_balance)-Number(this.form.paid)}},methods:{setData:function(t){if(this.form.id=t.id,this.form.customer_id=t.customer_id,this.form.total=t.total,this.form.paid=t.paid,this.form.status=t.status,this.form.note=t.note,this.$set(this,"temp_customer",t.customer),t.items){var e=this;t.items.forEach((function(t){e.form.items.push({id:t.id,product_id:t.product_id,price:t.price||0,quantity:t.quantity,code:t.product.code,name:t.product.name})}))}},handleSubmit:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(!this.form||!this.form.items||!this.form.items.length)return alert(this._t("Please Select Items")),!1;axios.post(route("Backend.Orders.Store"),this.form).then((function(n){t.$root.msgBox(n.data),t.$set(t,"form",JSON.parse(JSON.stringify(r))),t.temp_customer=null,t.product_temp=null,"function"==typeof e&&e()})).catch((function(e){t.$root.msgBox(e.response.data),console.log(e.response)}))},addProductToCart:function(t){var e=JSON.parse(JSON.stringify(this.form.items)),n=e.find((function(e){return e.code===t.code}));n?n.quantity++:e.push({product_id:t.id,price:t.price||0,quantity:1,code:t.code,name:t.name}),this.$set(this,"product_temp",null),this.$set(this.form,"items",e)}}},l=n("KHd+"),a=Object(l.a)(s,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("b-modal",t._b({attrs:{visible:"","hide-footer":"",title:t.__((t.form.id?"edit":"add")+"_order",(t.form.id?"Edit ":"Add ")+"Order")},on:{hidden:function(e){t.$router.go(-1),t.$emit("reset",!0),t.$emit("refreshDatatable",!0)}},scopedSlots:t._u([{key:"default",fn:function(e){var o=e.hide;return[n("b-form",{on:{submit:function(e){return e.preventDefault(),t.handleSubmit(o)}}},[n("b-form-group",{attrs:{label:t.__("select_customer","Select Customer"),"label-cols-md":"4"}},[n("vue-select",{attrs:{"init-options":!0,required:!0,"tag-text":function(e){return e?[e.id,e.name,e.phone,e.village].join(" # "):t.__("note_selected","Not Selected")},"option-text":function(e){return e?[e.id,e.name,e.phone,e.village].join(" # "):t.__("note_selected","Not Selected")},api_url:t.route("Backend.Customers.Search")},on:{input:function(e){t.form.customer_id=e?e.id:null,t.form.previous_balance=e?e.balance:0}},model:{value:t.temp_customer,callback:function(e){t.temp_customer=e},expression:"temp_customer"}})],1),t._v(" "),n("b-form-group",{staticClass:"mb-1",attrs:{label:t.__("select_products","Select Products"),"label-cols-md":"4"}},[n("vue-select",{ref:"productSelector",attrs:{"get-filtered":function(e){return e.filter((function(e){return!t.form.items.map((function(t){return t.code})).includes(e.code)}))},"init-options":!0,"option-text":function(e){return e?[e.id,e.name,e.code].join(" # "):t.__("note_selected","Not Selected")},"tag-text":function(e){return e?[e.id,e.name,e.code].join(" # "):t.__("note_selected","Not Selected")},api_url:t.route("Backend.Products.Search")},on:{input:t.addProductToCart},model:{value:t.product_temp,callback:function(e){t.product_temp=e},expression:"product_temp"}})],1),t._v(" "),n("b-table",{attrs:{responsive:"",bordered:"",small:"",hover:"",striped:"","head-variant":"dark",fields:t.item_fields,items:t.form.items},scopedSlots:t._u([{key:"cell(action)",fn:function(e){return[n("b-button",{attrs:{variant:"danger",size:"sm",title:t.__("remove","Remove")},on:{click:function(n){return t.form.items.splice(e.index,1)}}},[n("b-icon-trash")],1)]}},{key:"cell(quantity)",fn:function(e){return[n("b-input",{attrs:{type:"number",placeholder:t.__("item_quantity","Item Quantity"),size:"sm",step:"any",required:!0},model:{value:e.item.quantity,callback:function(n){t.$set(e.item,"quantity",n)},expression:"row.item.quantity"}})]}},{key:"cell(price)",fn:function(e){return[n("b-input",{attrs:{type:"number",placeholder:t.__("item_price","Item Price"),size:"sm",step:"any",required:!0},model:{value:e.item.price,callback:function(n){t.$set(e.item,"price",n)},expression:"row.item.price"}})]}},{key:"cell(total)",fn:function(e){return[t._v("\n                    "+t._s(t._f("currency")(Number(e.item.quantity)*Number(e.item.price)))+"\n                ")]}}],null,!0)}),t._v(" "),n("b-form-row",[n("b-col",{attrs:{md:"12",sm:"12"}},[n("b-form-group",{attrs:{"label-cols-md":"4",label:t.__("total","Total")}},[n("div",{staticClass:"form-control"},[t._v(t._s(t._f("currency")(t.total)))])]),t._v(" "),n("b-form-group",{attrs:{"label-cols-md":"4",label:t.__("previous_balance","Previous Balance")}},[n("div",{staticClass:"form-control"},[t._v(t._s(t._f("currency")(t.form.previous_balance)))])]),t._v(" "),n("b-form-group",{attrs:{label:t.__("cash_collection","Cash Collection"),"label-cols-md":"4"}},[n("b-input",{attrs:{lang:"bn",type:"number",step:"any"},model:{value:t.form.paid,callback:function(e){t.$set(t.form,"paid",e)},expression:"form.paid"}})],1),t._v(" "),n("b-form-group",{attrs:{"label-cols-md":"4",label:t.__("current_balance","Current Balance")}},[n("div",{staticClass:"form-control"},[t._v(t._s(t._f("currency")(t.currentBalance)))])]),t._v(" "),n("b-form-group",{attrs:{"label-cols-md":"4",label:t.__("note","Note")}},[n("b-textarea",{attrs:{placeholder:t.__("note","Note")},model:{value:t.form.note,callback:function(e){t.$set(t.form,"note",e)},expression:"form.note"}})],1)],1)],1),t._v(" "),n("b-button",{attrs:{type:"submit",block:"",variant:"dark"}},[t._v("\n                "+t._s(t.__("SUBMIT"))+"\n            ")])],1)]}}])},"b-modal",Object.assign({},t.BasicModalOptions,{size:"xl"}),!1))}),[],!1,null,null,null);e.default=a.exports},"xA+E":function(t,e,n){(e=n("JPst")(!1)).push([t.i,".vue-select .dropdown-menu {\n  max-height: 300px;\n  overflow-y: auto;\n  width: 100%;\n}\n.vue-select .dropdown-toggle::after {\n  position: absolute;\n  right: 10px;\n  top: 49%;\n}\n.vue-select .border-radius-0 {\n  border-radius: 0 !important;\n}\n.vue-select .top-reverse-100 {\n  top: -100% !important;\n}\n.vue-select .hide-dd-icon .dropdown-toggle::after {\n  display: none !important;\n}\n.vue-select.is-invalid, .vue-select.is-valid {\n  background-position: right calc(1.4em + 0.1875rem) center !important;\n}",""]),t.exports=e}}]);